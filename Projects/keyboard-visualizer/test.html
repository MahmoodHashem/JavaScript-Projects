<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dynamic Keyboard Input</title>
    <style>
      body {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
        background-color: #f0f0f0;
        font-family: Arial, sans-serif;
      }

      html {
        font-size: 10px;
      }

      @media screen and (max-width: 650px) {
        html {
          font-size: 8px;
        }
      }

      @media screen and (max-width: 550px) {
        html {
          font-size: 6px;
        }
      }
      .keyboard {
        display: flex;
        flex-direction: column;
        align-items: center;
        background-color: #fff;
        border-radius: 1rem;
        box-shadow: 0 0.4rem 1rem rgba(0, 0, 0, 0.1);
        padding: 2rem;
        margin-bottom: 2rem;
      }
      .numbers,
      .top,
      .middle,
      .bottom,
      .bottom2 {
        display: flex;
        margin-bottom: 1rem;
      }
      .key {
        width: 4rem;
        height: 4rem;
        background-color: #e0e0e0;
        border: 0.1rem solid #ccc;
        border-radius: 0.5rem;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 1.8rem;
        cursor: pointer;
        transition: background-color 0.3s;
        margin-right: 0.5rem;
      }
      .key.active {
        background-color: #4caf50;
        color: white;
      }
      .key.space {
        width: 18rem;
        margin: 2px;
      }

      .backspace {
        width: 10rem;
      }
      input {
        width: 100%;
        max-width: 40rem;
        height: 4rem;
        font-size: 1.8rem;
        margin-bottom: 1rem;
        padding: 0.5rem;
        border: 1px solid gray;
        border-radius: 0.5rem;
      }
      label {
        font-size: 2rem;
      }

      .copy {
        background-color: green;
        border: none;
        color: white;
        padding: 1rem;
        margin: 1rem;
        border-radius: 0.5rem;
      }
    </style>
  </head>
  <body>
    <input type="text" id="textInput" placeholder="Type here..." />
    <div class="keyboard" id="keyboard"></div>

    <label for="langs">Choose keyboard language:</label>
    <select id="langs" name="langs">
      <option value="en-US">English</option>
      <option value="fa">Persian</option>
      <option value="pashto">Pashto</option>
    </select>

    <button id="copy" class="copy">Copy to Clipboard</button>

    <script>
      const keyboardElement = document.getElementById("keyboard");
      const selected = document.querySelector("#langs");
      const textInput = document.getElementById("textInput");

      const keyboardLangs = {
        english: {
          numbers: [
            "1",
            "2",
            "3",
            "4",
            "5",
            "6",
            "7",
            "8",
            "9",
            "0",
            "Backspace",
          ],
          top: ["Q", "W", "E", "R", "T", "Y", "U", "I", "O", "P"],
          middle: ["A", "S", "D", "F", "G", "H", "J", "K", "L"],
          bottom: ["Z", "X", "C", "V", "B", "N", "M"],
        },

        persian: {
          numbers: [
            "1",
            "2",
            "3",
            "4",
            "5",
            "6",
            "7",
            "8",
            "9",
            "0",
            "Backspace",
          ],
          top: ["ض", "ص", "ث", "ق", "ف", "غ", "ع", "ه", "خ", "ح", "ج", "چ"],
          middle: ["ش", "س", "ی", "ب", "ل", "ا", "ت", "ن", "م", "ک", "گ", "پ"],
          bottom: ["ظ", "ط", "ز", "ر", "ذ", "د", "ئ", "و"],
        },
        pashto: {
          numbers: [
            "1",
            "2",
            "3",
            "4",
            "5",
            "6",
            "7",
            "8",
            "9",
            "0",
            "Backspace",
          ],
          top: ["ض", "ص", "ث", "ق", "ف", "غ", "ع", "ه", "ج", "چ", "ځ", "خ"],
          middle: ["ښ", "ش", "س", "ۍ", "ی", "ي", "ب", "ل", "ا", "ت", "ټ", "پ"],
          bottom: ["ر", "ذ", "ظ", "ط", "د", "ډ", "ړ", "ئ", "ې", "و", "ړ", "ږ"],
          bottom2: ["ڼ", "ن", "م", "ک", "ګ", "ز", "ژ", "ء", "ح"],
        },
      };

      function render(language) {
        // Clear existing keyboard
        keyboardElement.innerHTML = "";

        // Create keyboard layout based on the selected language
        for (const row in language) {
          const rowDiv = document.createElement("div");
          rowDiv.className = row;

          language[row].forEach((key) => {
            const keyButton = document.createElement("button");
            keyButton.className = "key";
            keyButton.textContent = key;
            if (keyButton.textContent === "Backspace") {
              keyButton.classList.add("backspace");
            }
            keyButton.addEventListener("mousedown", () => {
              keyButton.classList.add("active");
              // Add the clicked key to the input field
              if (key === " ") {
                textInput.value += " ";
              } else if (key === "Backspace") {
                textInput.value = textInput.value.slice(0, -1);
              } else {
                textInput.value += key;
              }
            });
            keyButton.addEventListener("mouseup", () => {
              keyButton.classList.remove("active");
            });
            rowDiv.appendChild(keyButton);
          });

          keyboardElement.appendChild(rowDiv);
        }

        // Create the space bar
        const spaceButton = document.createElement("button");
        spaceButton.className = "key space";
        spaceButton.textContent = "Space";
        spaceButton.addEventListener("mousedown", () => {
          spaceButton.classList.add("active");
          textInput.value += " "; // Add space to input
        });
        spaceButton.addEventListener("mouseup", () => {
          spaceButton.classList.remove("active");
        });
        keyboardElement.appendChild(spaceButton);

        // const backspaceButton = document.createElement("button");
        // backspaceButton.className = "key backspace";
        // backspaceButton.textContent = "Backspace";
        // backspaceButton.addEventListener("mousedown", () => {
        //     backspaceButton.classList.add("active");
        //     // Remove the last character from the input field
        //     textInput.value = textInput.value.slice(0, -1);
        // });
        // backspaceButton.addEventListener("mouseup", () => {
        //     backspaceButton.classList.remove("active");
        // });
        // keyboardElement.appendChild(backspaceButton);
      }

      // Initial render
      render(keyboardLangs.english);

      selected.addEventListener("change", () => {
        const lang = selected.value;
        if (lang === "fa") {
          render(keyboardLangs.persian);
        } else if (lang === "pashto") {
          render(keyboardLangs.pashto);
        } else {
          render(keyboardLangs.english);
        }
      });

      // Handle physical keyboard input
      document.addEventListener("keydown", (event) => {
        const key = event.key.toUpperCase();
        const keyElements = document.querySelectorAll(".key");
        keyElements.forEach((k) => {
          if (
            k.textContent === key ||
            (key === " " && k.classList.contains("space"))
          ) {
            k.classList.add("active");
          }
        });
      });

      document.addEventListener("keyup", (event) => {
        const key = event.key.toUpperCase();
        const keyElements = document.querySelectorAll(".key");
        keyElements.forEach((k) => {
          if (
            k.textContent === key ||
            (key === " " && k.classList.contains("space"))
          ) {
            k.classList.remove("active");
          }
        });
      });

      document.getElementById("copy").addEventListener("click", function () {
        const inputField = textInput;
        const textToCopy = inputField.value;

        // Use the Clipboard API
        if (navigator.clipboard) {
          navigator.clipboard
            .writeText(textToCopy)
            .then(() => {
              alert("Copied");
            })
            .catch((err) => {
              alert("Failed to copy text: " + err);
            });
        } else {
          // Fallback for browsers that do not support the Clipboard API
          inputField.select();
          try {
            const successful = document.execCommand("copy");
            const msg = successful ? "Copied" : "Failed to copy";
            alert(msg);
          } catch (err) {
            alert("Failed to copy text: " + err);
          }
        }
      });
    </script>
  </body>
</html>
